@{ ViewBag.Title = "City List"; }

<div class="container">
    <div class="row  mb-2">
        <div class="col-sm-6">
            <a class="h5 text-info" asp-area="Master" asp-controller="City" asp-action="Index">City List</a>
        </div>
        <div class="col-sm-6 text-right">
            <button class="btn btn-success btn-sm" type="button" id="add-new-city"><i class="fas fa-plus-square"></i> New</button>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-sm-12 table-responsive">
        <table id="cityGrid" class="table table-sm table-striped table-bordered table-hover" style="width: 100%;">
            <thead>
                <tr class="table-header">
                    @*<th>City Id</th>*@
                    <th>Action</th>
                    <th>City Name</th>
                    <th>State Name</th>
                    <th>Country Name</th>
                </tr>
            </thead>
        </table>
    </div>
</div>
<div id="modal-city-master" class="modal fade" role="dialog" data-backdrop="static" data-keyboard="true"></div>
<script>
$(document).ready(function () {
    $("#cityGrid").DataTable({
       
        //dom: 'lftip',
        "pageLength": 10,
        "lengthMenu": [[5, 10, 25, -1], [5, 10, 25, "All"]],
        "bPaginate": true,
        //"bInfo": true,
        //"bRetrieve": true,
        //"bFilter": true,
        //"iDisplayLength": 5,
        //"bSort": true,
        //"aaSorting": [],
        //"order": [],
        //scrollY: "50vh",
        //scrollCollapse: true,
       
        "ajax": {
            "url": "@Url.Action("GetCityList", "City")",
            "type": "POST",
            "datatype": "json",
        },
        "columns": [
        /*{ "data": "CityId", "name": "City Id" },*/

            {
                "render": function (data, type, full, meta) {
                    return '<div class="action_button">' +
                        '<button type="button" class="border-0 rounded-0 text-success" onclick="javascript: fnEditCity(' + full.CityId + ')"><span class="fa fa-pencil-alt"></span></button>' +
                        '<button type="button" class="border-0 rounded-0 text-danger" data-toggle="modal" onclick="javascript: fnDeleteCity(this, ' + full.CityId + ')"><span class="fa fa-trash-alt"></span></button>' +
                        '</div>';
                }, "orderable": false
            },
            { "data": "CityName", "name": "City Name"},
            { "data": "StateName", "name": "State Name" },
            { "data": "CountryName", "name": "Country Name" }
        ],
    });
});

// add new record.
$('#add-new-city').click(function () {
    AjaxCommunication.CreateRequest(this.window, 'Get', '@Url.Action("AddCity", "City")', 'html', '',
    function (data) {
        $('#modal-city-master').empty();
        $('#modal-city-master').html(data).modal('show');
        return false;
    }, null, true, null, false);
});

// edit city
    function fnEditCity(cityId) {
        var model = { cityId: cityId };
        AjaxCommunication.CreateRequest(this.window, 'Get', '@Url.Action("EditCity", "City")', 'html', model,
        function (data) {
            $('#modal-city-master').empty();
            $('#modal-city-master').html(data).modal('show');
            return false;
        }, null, true, null, false);
    }
</script>

@{ await Html.RenderPartialAsync("_ConfirmDeleteCity"); }
